{"version":3,"sources":["webpack://StickyAlgo/webpack/universalModuleDefinition","webpack://StickyAlgo/webpack/bootstrap","webpack://StickyAlgo/./node_modules/curator-core/build/curator-core.js","webpack://StickyAlgo/./node_modules/curator-core/build/helpers.js","webpack://StickyAlgo/./node_modules/curator-core/build/options.js","webpack://StickyAlgo/./node_modules/curator-core/index.js","webpack://StickyAlgo/./src/StickyAlgo.js"],"names":["StickyAlgo","itemProps","previousX","x","previousY","y","previousWidth","width","previousHeight","height","item","newX","newY","newWidth","newHeight","grid","gridOptions","algoData","revertedItems","revertPreviousMovements","state","items","gridColumns","gridRows","allItems","forEach","i","id","collisions","getCollisions","hasHitGluedElement","success","updatedItem","SnapperCore","updateGridWithItemMovement","setPreviousMovements","_canResizeX","itemsCanResizeGrid","resizeGridDirections","_canResizeY","getMoveDetails","itemsToMove","maxRows","maxCols","updatedItems","itm","clone","collisionCount","length","Math","max","gridSizing","result","run","force","movedItem","revertInYDirection","xLimit","helpers","isDefined","_getCloserPosition","push","movedIds","stickyElements","previousMovements","filter","sort","m1","m2","xDiff","_id","diffY","diffX","yIterator","sign","xIterator","canFit","j","block","findGluedElement","find","glued","gluedElements","gluedItemsCount","largestEl","iteratedItem","whitelistIds","yLimit","cell","gridItem","visible","indexOf","objIsInArray","correctedX","draggedItem","handleCollisions","newCollisions","currentCollision","nextCollisions","getNextGluedFreeCollisions","concat","rowsRequired","columnsRequired","Object","keys","map","key","gluedElement","movingXDir","findLargestGluedElement","yOffset","xOffset","limit","collision","minY","Number","MAX_SAFE_INTEGER","minX","min"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA,IAAI,IAAyD;AAC7D;AACA,MAAM,EAK6B;AACnC,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gCAAgC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,kBAAkB;AAClF;AACA,yDAAyD,cAAc;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,iCAAiC;AAClF,wHAAwH,mBAAmB,EAAE;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qDAAqD,+BAA+B,8DAA8D,YAAY,oCAAoC,6DAA6D,YAAY,6BAA6B,OAAO,2BAA2B,0CAA0C,wEAAwE,2BAA2B,EAAE,EAAE,eAAe;;AAE1e,0DAA0D,+BAA+B,iBAAiB,sCAAsC,YAAY,YAAY,uBAAuB,OAAO,qBAAqB,0CAA0C,2BAA2B,EAAE,eAAe;;AAEjT,gCAAgC,gBAAgB,sBAAsB,OAAO,uDAAuD,mCAAmC,0DAA0D,sFAAsF,gEAAgE,EAAE,GAAG,EAAE,iCAAiC,2CAA2C,EAAE,EAAE,EAAE,eAAe;;AAE/d,2CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY;;AAE/M,kCAAkC,iFAAiF;;AAEnH,+BAA+B,wEAAwE;;AAEvG,iCAAiC,+HAA+H;;AAEhK,kCAAkC,0BAA0B,8CAA8C,gBAAgB,OAAO,kBAAkB,EAAE,aAAa,EAAE;;AAEpK;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA,mBAAmB,cAAc;AACjC;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,2FAA2F;AAC3F;AACA;;AAEA;AACA,6BAA6B;AAC7B,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,iEAAiE;;AAEjE;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC;;AAEpC;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,uCAAuC;AACvC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA,6CAA6C;AAC7C,2CAA2C;AAC3C;;AAEA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,6BAA6B;AAC7B;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,qCAAqC;AACrC,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,8JAA8J;AAC9J,GAAG;AACH;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA,sCAAsC;;AAEtC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yLAAyL;;;AAGzL;AACA;;AAEA,yCAAyC;AACzC;AACA,SAAS;AACT,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B,4BAA4B;AAC5B;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B;AACA,KAAK;;AAEL;AACA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B,4BAA4B;AAC5B;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B;AACA,KAAK;;AAEL;AACA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E;;AAE1E;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA,oEAAoE,8BAA8B;AAClG;AACA;AACA;;AAEA,mBAAmB,gBAAgB;AACnC,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,6BAA6B;AAC7B;AACA;AACA;AACA,OAAO;AACP;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,CAAC;;AAED,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wGAAwG,uBAAuB,EAAE;AACjI,uGAAuG,sBAAsB,EAAE;AAC/H,4GAA4G,2BAA2B,EAAE;AACzI,4GAA4G,2BAA2B,EAAE;AACzI,kHAAkH,iCAAiC,EAAE;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF;AACxF;AACA,gGAAgG;AAChG;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP,UAAU;AACV,CAAC;AACD,wC;;;;;;;;;;;ACl/BA;AACA,IAAI,IAAyD;AAC7D;AACA,MAAM,EAKwB;AAC9B,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gCAAgC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,kBAAkB;AAClF;AACA,yDAAyD,cAAc;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,iCAAiC;AAClF,wHAAwH,mBAAmB,EAAE;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,CAAC;;AAED,OAAO;;AAEP,UAAU;AACV,CAAC;AACD,mC;;;;;;;;;;;AC/HA;AACA,IAAI,IAAyD;AAC7D;AACA,MAAM,EAKwB;AAC9B,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gCAAgC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,kBAAkB;AAClF;AACA,yDAAyD,cAAc;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,iCAAiC;AAClF,wHAAwH,mBAAmB,EAAE;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wGAAwG,uBAAuB,EAAE;AACjI,uGAAuG,sBAAsB,EAAE;AAC/H,4GAA4G,2BAA2B,EAAE;AACzI,4GAA4G,2BAA2B,EAAE;AACzI,kHAAkH,iCAAiC,EAAE;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"sticky-algo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StickyAlgo\"] = factory();\n\telse\n\t\troot[\"StickyAlgo\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/StickyAlgo.js\");\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"curator-core\"] = factory();\n\telse\n\t\troot[\"curator-core\"] = factory();\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/curator-core.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/curator-core.js\":\n/*!*****************************!*\\\n  !*** ./src/curator-core.js ***!\n  \\*****************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./helpers */ \"./src/helpers.js\");\n/* harmony import */ var _options__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./options */ \"./src/options.js\");\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\n// Snapper core is responsible for handling all logic for interacting with the grid\n// except:\n// 1. direct ui manipulation (responsibility of the wrapper)\n// 2. internal grid determination (responsibility of the algorithm)\n// 3. Maintenence of state (responsibility of the wrapper)\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  getItemStyles: function getItemStyles() {\n    return {\n      boxSizing: 'border-box',\n      position: 'absolute'\n    };\n  },\n  getItemClasses: function getItemClasses() {\n    var itemOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _options__WEBPACK_IMPORTED_MODULE_1__[\"defaultItemOptions\"];\n\n    var classes = _toConsumableArray(itemOptions.classes).concat([itemOptions.itemClassName]);\n\n    if (itemOptions.glued) {\n      classes.push('snapper-glued');\n    }\n\n    return classes;\n  },\n  getEmptyGrid: function getEmptyGrid(gridRows) {\n    var grid = [];\n\n    for (var r = 0; r < gridRows; r++) {\n      grid.push([]);\n    }\n\n    return grid;\n  },\n  /// \n  /// Calculate the position of the item within the grid\n  ///\n  getItemPosition: function getItemPosition(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top, renderMode) {\n    var flex = renderMode === _options__WEBPACK_IMPORTED_MODULE_1__[\"renderModeType\"].flex; // even though the container could change and these calculations need to rerun on that event,\n    // it looks much nicer if theyre percentages on the widgets - even if it temporarily gives a 1px gap\n    // and then closes the gap on mouse up, than having px values \n\n    if (flex) {\n      return _objectSpread({}, this.getItemPositionPixels(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top), this.getItemPositionPercentages(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top));\n    } else {\n      return this.getItemPositionPixels(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top);\n    }\n  },\n  getItemPositionPercentages: function getItemPositionPercentages(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top) {\n    var pxPerColFloored = Math.floor(gridWidth / gridCols);\n    var pxPerRowFloored = Math.floor(gridHeight / gridRows);\n    var colRemainderPx = gridWidth - pxPerColFloored * gridCols;\n    var rowRemainderPx = gridHeight - pxPerRowFloored * gridRows; // todo check if need to * by required precision and floor to avoid decimal calc\n\n    var widthPxOffset = 49 / gridWidth / 100;\n    var heightPxOffset = 49 / gridHeight / 100;\n    var extraLeft = Math.min(left, colRemainderPx);\n    var extraWidth = Math.min(width + left, colRemainderPx) - extraLeft;\n    var extraTop = Math.min(top, rowRemainderPx);\n    var extraHeight = Math.min(height + top, rowRemainderPx) - extraTop; // shift it by 2/5 px percent to always count for rounding errors\n    // could do anything below 1/2 but this is sufficient as \n    // (40 / x = 0.01% limit => pxLimit = 40 / 0.01 = 4000px\n\n    var leftPct = (left * pxPerColFloored + extraLeft) * 100 / gridWidth + widthPxOffset;\n    var widthPct = (width * pxPerColFloored + extraWidth) * 100 / gridWidth + widthPxOffset;\n    var topPct = (top * pxPerRowFloored + extraTop) * 100 / gridHeight + heightPxOffset;\n    var heightPct = (height * pxPerRowFloored + extraHeight) * 100 / gridHeight + heightPxOffset;\n    var ending = '%';\n    return {\n      leftPct: leftPct,\n      widthPct: widthPct,\n      topPct: topPct,\n      heightPct: heightPct,\n      ending: ending\n    };\n  },\n  getItemPositionPixels: function getItemPositionPixels(gridWidth, gridHeight, gridRows, gridCols, width, height, left, top) {\n    var pxPerColFloored = Math.floor(gridWidth / gridCols);\n    var pxPerRowFloored = Math.floor(gridHeight / gridRows);\n    var colRemainderPx = gridWidth - pxPerColFloored * gridCols;\n    var rowRemainderPx = gridHeight - pxPerRowFloored * gridRows;\n    var extraLeft = Math.min(left, colRemainderPx);\n    var extraWidth = Math.min(width + left, colRemainderPx) - extraLeft;\n    var extraTop = Math.min(top, rowRemainderPx);\n    var extraHeight = Math.min(height + top, rowRemainderPx) - extraTop;\n    var widthPx = pxPerColFloored * width + extraWidth;\n    var heightPx = pxPerRowFloored * height + extraHeight;\n    var topPx = pxPerRowFloored * top + extraTop;\n    var leftPx = pxPerColFloored * left + extraLeft;\n    var ending = 'px';\n    return {\n      widthPx: widthPx,\n      heightPx: heightPx,\n      topPx: topPx,\n      leftPx: leftPx,\n      ending: ending\n    };\n  },\n  updateMovedItem: function updateMovedItem(item, gridSizing, gridOptions) {\n    var newX = item.newX,\n        newY = item.newY,\n        newWidth = item.newWidth,\n        newHeight = item.newHeight;\n    var gridWidth = gridSizing.gridWidth,\n        gridHeight = gridSizing.gridHeight,\n        gridRows = gridSizing.gridRows,\n        gridColumns = gridSizing.gridColumns;\n    var renderMode = gridOptions.renderMode;\n\n    var movedItem = _objectSpread({}, item);\n\n    if (!(newWidth && newHeight)) {\n      console.error(\"Item \".concat(key, \" does not have a newWidth or newHeight value. Unable to correctly resize item\"));\n      return item;\n    } // update the values with the set new values\n\n\n    movedItem.x = newX;\n    movedItem.y = newY;\n    movedItem.width = newWidth;\n    movedItem.height = newHeight;\n    var position = this.getItemPosition(gridWidth, gridHeight, gridRows, gridColumns, movedItem.width, movedItem.height, movedItem.x, movedItem.y, renderMode);\n    var styles = this.getItemPositionStyles(gridOptions, movedItem.styles, position);\n    movedItem.position = _objectSpread({}, position);\n    movedItem.styles = _objectSpread({}, styles);\n    return movedItem;\n  },\n  updateGridWithMovedItems: function updateGridWithMovedItems(grid, items) {\n    for (var _key in items) {\n      var movedItem = items[_key];\n      this.updateGridWithItemMovement(grid, movedItem, movedItem.x, movedItem.y, movedItem.width, movedItem.height);\n    }\n  },\n  getUpdatedMovedItems: function getUpdatedMovedItems(items, draggedItemId, newTopPx, newLeftPx, newWidthPx, newHeightPx, gridSizing, gridOptions) {\n    var _this = this;\n\n    return items.forEach(function (item) {\n      var movedItem = _this.updateMovedItem(item, gridSizing, gridOptions);\n\n      if (key === draggedItemId) {\n        // todo sync the %\n        var position = _objectSpread({}, movedItem.position, {\n          ending: 'px',\n          topPx: newTopPx,\n          leftPx: newLeftPx,\n          widthPx: newWidthPx,\n          heightPx: newHeightPx\n        });\n\n        var styles = _this.getItemPositionStyles(gridOptions, movedItem.styles, position);\n\n        movedItem.position = _objectSpread({}, position);\n        movedItem.styles = _objectSpread({}, styles);\n      }\n\n      return movedItem;\n    });\n  },\n  getUpdatedGridSizeItems: function getUpdatedGridSizeItems(items, gridOptions, gridSizing) {\n    var _this2 = this;\n\n    var ignoreIds = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];\n    var renderMode = gridOptions.renderMode;\n    var gridRows = gridSizing.gridRows,\n        gridColumns = gridSizing.gridColumns,\n        gridHeight = gridSizing.gridHeight,\n        gridWidth = gridSizing.gridWidth;\n    return items.map(function (item) {\n      if (ignoreIds.indexOf(item.id) > -1) return;\n\n      var position = _this2.getItemPosition(gridWidth, gridHeight, gridRows, gridColumns, item.width, item.height, item.x, item.y, renderMode);\n\n      var styles = _this2.getItemPositionStyles(gridOptions, item.styles, position);\n\n      return _objectSpread({}, item, {\n        position: position,\n        styles: styles\n      });\n    });\n  },\n  getGridBoundaries: function getGridBoundaries(gridSizing) {\n    var gridWidth = gridSizing.gridWidth,\n        gridHeight = gridSizing.gridHeight;\n    return {\n      leftBoundary: 0,\n      rightBoundary: gridWidth,\n      topBoundary: 0,\n      bottomBoundary: gridHeight\n    };\n  },\n  getItemSizing: function getItemSizing(itemProps, gridSizing) {\n    var gridWidth = gridSizing.gridWidth,\n        gridHeight = gridSizing.gridHeight;\n    var width = itemProps.width,\n        height = itemProps.height;\n    var pxPerColumn = gridWidth / gridColumns;\n    var pxPerRow = gridHeight / gridRows;\n    var itemWidthPx = width * pxPerColumn;\n    var itemHeightPx = height * pxPerRow;\n    return {\n      itemWidthPx: itemWidthPx,\n      itemHeightPx: itemHeightPx\n    };\n  },\n  calculateGridMatrixSize: function calculateGridMatrixSize(items, gridOptions, gridSizing) {\n    var itemsCanResizeGrid = gridOptions.itemsCanResizeGrid,\n        resizeGridDirections = gridOptions.resizeGridDirections;\n    var gridRows = gridSizing.gridRows,\n        gridColumns = gridSizing.gridColumns;\n    var canResizeX = itemsCanResizeGrid && resizeGridDirections !== 'y';\n    var canResizeY = itemsCanResizeGrid && resizeGridDirections !== 'x';\n\n    if (!(canResizeX || canResizeY)) {\n      return {\n        rows: gridRows,\n        columns: gridColumns\n      };\n    }\n\n    var rowsRequired = 0;\n    var columnsRequired = 0;\n    items.forEach(function (item) {\n      var rightBoundary = item.x + item.width;\n      var bottomBoundary = item.y + item.height;\n      if (rightBoundary > columnsRequired) columnsRequired = rightBoundary;\n      if (bottomBoundary > rowsRequired) rowsRequired = bottomBoundary;\n    });\n    return {\n      rows: canResizeY ? Math.max(rowsRequired, gridRows) : gridRows,\n      columns: canResizeX ? Math.max(columnsRequired, gridColumns) : gridColumns\n    };\n  },\n  calculateGridSize: function calculateGridSize(gridSizing, gridOptions, newRowCount, newColumnCount) {\n    var gridRows = gridOptions.gridRows,\n        gridColumns = gridOptions.gridColumns;\n    var widthPx = gridSizing.widthPx,\n        heightPx = gridSizing.heightPx;\n    var newGridWidth = widthPx / gridColumns * newColumnCount;\n    var newGridHeight = heightPx / gridRows * newRowCount;\n    return {\n      newGridWidth: newGridWidth,\n      newGridHeight: newGridHeight\n    };\n  },\n  calculateMovementChange: function calculateMovementChange(itemProps, gridOptions, gridSizing, movementDetails) {\n    var gridResizeable = gridOptions.itemsCanResizeGrid;\n    var canResizeX = gridResizeable && gridOptions.resizeGridDirections !== 'y';\n    var canResizeY = gridResizeable && gridOptions.resizeGridDirections !== 'x';\n    var pxPerColumn = gridSizing.widthPx / gridOptions.gridColumns;\n    var pxPerRow = gridSizing.heightPx / gridOptions.gridRows;\n    var xDiff = movementDetails.currentMouseX - movementDetails.initialMouseX;\n    var yDiff = movementDetails.currentMouseY - movementDetails.initialMouseY;\n    var newLeftPx = movementDetails.initialLeft + xDiff;\n    var newTopPx = movementDetails.initialTop + yDiff;\n    var newX = Math.round(newLeftPx / pxPerColumn);\n    var newY = Math.round(newTopPx / pxPerRow);\n\n    if (newX < 0) {\n      newX = 0;\n    } else if (newX + 1 > gridOptions.gridColumns && !canResizeX) {\n      newX = gridOptions.gridColumns - 1;\n    }\n\n    if (newY < 0) {\n      newY = 0;\n    } else if (newY + 1 > gridOptions.gridRows && !canResizeY) {\n      newY = gridOptions.gridRows - 1;\n    }\n\n    return {\n      newX: newX,\n      newY: newY,\n      newLeftPx: newLeftPx,\n      newTopPx: newTopPx\n    };\n  },\n  calculateResizeChange: function calculateResizeChange(itemProps, gridOptions, gridSizing, movementDetails) {\n    var pxPerColumn = gridSizing.widthPx / gridOptions.gridColumns;\n    var pxPerRow = gridSizing.heightPx / gridOptions.gridRows;\n    var xDiff = movementDetails.currentMouseX - movementDetails.initialMouseX;\n    var yDiff = movementDetails.currentMouseY - movementDetails.initialMouseY;\n    var newWidthPx = movementDetails.initialWidth + xDiff;\n    var newHeightPx = movementDetails.initialHeight + yDiff;\n    var newWidth = Math.round(newWidthPx / pxPerColumn);\n    var newHeight = Math.round(newHeightPx / pxPerRow);\n\n    if (newWidthPx < pxPerColumn) {\n      newWidth = 1;\n      newWidthPx = pxPerColumn;\n    }\n\n    if (newHeightPx < pxPerRow) {\n      newHeight = 1;\n      newHeightPx = pxPerRow;\n    }\n\n    return {\n      newWidthPx: newWidthPx,\n      newHeightPx: newHeightPx,\n      newWidth: newWidth,\n      newHeight: newHeight,\n      newLeftPx: itemProps.position.leftPx,\n      newTopPx: itemProps.position.topPx\n    };\n  },\n  calculatePositionChange: function calculatePositionChange(itemProps, state) {\n    var gridSizing = state.gridSizing,\n        gridOptions = state.gridOptions;\n    var pxPerColumn = gridSizing.widthPx / gridOptions.gridColumns;\n    var pxPerRow = gridSizing.heightPx / gridOptions.gridRows;\n    return {\n      newWidthPx: Math.round(pxPerColumn * itemProps.width),\n      newHeightPx: Math.round(pxPerRow * itemProps.height),\n      newLeftPx: Math.round(pxPerColumn * itemProps.x),\n      newTopPx: Math.round(pxPerRow * itemProps.y),\n      newX: itemProps.x,\n      newY: itemProps.y,\n      newWidth: itemProps.width,\n      newHeight: itemProps.height\n    };\n  },\n  getNoMovementResult: function getNoMovementResult(state, itemProps, movementChange) {\n    var targetItem = _objectSpread({}, itemProps, {\n      position: _objectSpread({}, itemProps.position, {\n        ending: 'px',\n        topPx: movementChange.newTopPx,\n        // todo this is wrong\n        leftPx: movementChange.newLeftPx,\n        widthPx: movementChange.newWidthPx,\n        heightPx: movementChange.newHeightPx\n      })\n    });\n\n    var updatedItems = state.items.map(function (item) {\n      if (item.id == targetItem.id) {\n        return targetItem;\n      }\n\n      return item;\n    });\n    return {\n      success: true,\n      // todo should this be false?\n      grid: state.grid,\n      updatedItems: updatedItems,\n      targetItem: targetItem,\n      gridSizing: state.gridSizing,\n      movementChange: movementChange,\n      itemsMoved: false\n    };\n  },\n  itemHasMoved: function itemHasMoved(itemProps, movementChange) {\n    return movementChange.newX != itemProps.x || movementChange.newY != itemProps.y;\n  },\n  itemHasResized: function itemHasResized(itemProps, movementChange) {\n    return movementChange.newWidth !== itemProps.width || movementChange.newHeight !== itemProps.height;\n  },\n  checkProposedGridSizing: function checkProposedGridSizing(state, proposedGridColumns, proposedGridRows) {\n    var gridOptions = state.gridOptions;\n    var canResizeX = gridOptions.resizeGridDirections !== _options__WEBPACK_IMPORTED_MODULE_1__[\"resizeOptions\"].y;\n    var canResizeY = gridOptions.resizeGridDirections !== _options__WEBPACK_IMPORTED_MODULE_1__[\"resizeOptions\"].x;\n    if (!canResizeX && proposedGridColumns !== gridOptions.gridColumns || gridOptions.gridColumns < 1) throw 'Invalid grid column proposition from algorithm';else if (!canResizeY && proposedGridRows !== gridOptions.gridRows || gridOptions.gridRows < 1) throw 'Invalid grid row proposition from algorithm';\n  },\n  getPlaceholderStyles: function getPlaceholderStyles(position) {\n    return _objectSpread({}, _options__WEBPACK_IMPORTED_MODULE_1__[\"defaultPlaceholderStyles\"], {\n      left: \"\".concat(position.leftPx, \"px\"),\n      top: \"\".concat(position.topPx, \"px\"),\n      width: \"\".concat(position.widthPx, \"px\"),\n      height: \"\".concat(position.heightPx, \"px\")\n    });\n  },\n  addItemToGrid: function addItemToGrid(itemProps, state) {\n    var movementChange = {\n      newX: itemProps.x,\n      newY: itemProps.y,\n      newWidth: itemProps.width,\n      newHeight: itemProps.height,\n      newTopPx: itemProps.position.topPx,\n      newLeftPx: itemProps.position.leftPx,\n      newWidthPx: itemProps.position.widthPx,\n      newHeightPx: itemProps.position.heightPx\n    };\n    return this.onItemMovement(itemProps, state, movementChange);\n  },\n  movementIsWithinBounds: function movementIsWithinBounds(movementChange, gridOptions) {\n    var gridColumns = gridOptions.gridColumns,\n        gridRows = gridOptions.gridRows,\n        itemsCanResizeGrid = gridOptions.itemsCanResizeGrid,\n        resizeGridDirections = gridOptions.resizeGridDirections;\n    var newX = movementChange.newX,\n        newY = movementChange.newY,\n        newWidth = movementChange.newWidth,\n        newHeight = movementChange.newHeight;\n    var canResizeX = itemsCanResizeGrid && resizeGridDirections !== 'y';\n    var canResizeY = itemsCanResizeGrid && resizeGridDirections !== 'x';\n    return (canResizeX || newX + newWidth <= gridColumns) && (canResizeY || newY + newHeight <= gridRows);\n  },\n  onItemMovement: function onItemMovement(itemProps, state, movementChange) {\n    var _this3 = this;\n\n    var renderMode = state.gridOptions.renderMode;\n    var gridOptions = state.gridOptions;\n    var defaultResult = this.getNoMovementResult(state, itemProps, movementChange);\n\n    var draggedItem = _objectSpread({}, itemProps);\n\n    if (!this.movementIsWithinBounds(movementChange, gridOptions)) {\n      return defaultResult;\n    }\n\n    var dragResult = gridOptions.algo.run(state, draggedItem, movementChange.newX, movementChange.newY, movementChange.newWidth, movementChange.newHeight);\n\n    if (!dragResult.success) {\n      return defaultResult;\n    }\n\n    var gridResized = dragResult.gridColumns !== gridOptions.gridColumns || dragResult.gridRows !== gridOptions.gridRows;\n    var gridWidth = state.gridSizing.widthPx;\n    var gridHeight = state.gridSizing.heightPx;\n\n    if (gridResized) {\n      this.checkProposedGridSizing(state, dragResult.gridColumns, dragResult.gridRows);\n      var newSize = this.calculateGridSize(state.gridSizing, gridOptions, dragResult.gridRows, dragResult.gridColumns);\n      gridWidth = newSize.newGridWidth;\n      gridHeight = newSize.newGridHeight;\n    }\n\n    var updatedItems = Object.keys(dragResult.itemsToMove).map(function (key) {\n      var movedItem = dragResult.itemsToMove[key];\n\n      var position = _this3.getItemPosition(gridWidth, gridHeight, dragResult.gridRows, dragResult.gridColumns, movedItem.width, movedItem.height, movedItem.x, movedItem.y, renderMode); // without these the item will jitter\n\n\n      if (movedItem.id === draggedItem.id) {\n        var placeholderStyles = _this3.getPlaceholderStyles(position);\n\n        movedItem.meta = _objectSpread({}, movedItem.meta, {\n          placeholderStyles: placeholderStyles\n        });\n        movedItem.position = _objectSpread({}, movedItem.position, {\n          ending: 'px',\n          topPx: movementChange.newTopPx,\n          leftPx: movementChange.newLeftPx,\n          widthPx: movementChange.newWidthPx,\n          heightPx: movementChange.newHeightPx\n        });\n        movedItem.styles = _this3.getItemPositionStyles(gridOptions, movedItem.styles, movedItem.position);\n        console.log(movedItem.styles);\n      } else {\n        movedItem.position = position;\n        movedItem.styles = _this3.getItemPositionStyles(gridOptions, movedItem.styles, position);\n      }\n\n      return movedItem;\n    });\n    return {\n      success: dragResult.success,\n      grid: state.grid,\n      updatedItems: updatedItems,\n      itemsMoved: Object.keys(dragResult.itemsToMove).length > 1,\n      targetItem: draggedItem,\n      movementChange: movementChange,\n      gridSizing: {\n        gridRows: dragResult.gridRows,\n        gridColumns: dragResult.gridColumns,\n        heightPx: gridHeight,\n        widthPx: gridWidth\n      }\n    };\n  },\n  onItemPositionChanged: function onItemPositionChanged(itemProps, previousItemProps, state) {\n    var positionChange = this.calculatePositionChange(itemProps, state);\n\n    if (!this.positionHasChanged(itemProps, previousItemProps)) {\n      return this.getNoMovementResult(state, previousItemProps, positionChange);\n    }\n\n    return this.onItemMovement(previousItemProps, state, positionChange);\n  },\n  positionHasChanged: function positionHasChanged(itemProps, previousItemProps) {\n    return itemProps.x !== previousItemProps.x || itemProps.y !== previousItemProps.y || itemProps.width !== previousItemProps.width || itemProps.height !== previousItemProps.height;\n  },\n  onItemDragStart: function onItemDragStart(itemProps) {\n    if (itemProps.glued) return {\n      item: itemProps,\n      success: false\n    };\n    var placeholderStyles = this.getPlaceholderStyles(itemProps.position);\n\n    var item = _objectSpread({}, itemProps, {\n      meta: _objectSpread({}, itemProps.meta, {\n        isDragging: true,\n        placeholderStyles: placeholderStyles\n      })\n    });\n\n    return {\n      item: item,\n      success: true\n    };\n  },\n  ///\n  /// Handles all drag logic\n  ///\n  onItemDrag: function onItemDrag(itemProps, state, movementDetails) {\n    var movementChange = _objectSpread({}, this.calculateMovementChange(itemProps, state.gridOptions, state.gridSizing, movementDetails), {\n      newWidth: itemProps.width,\n      newHeight: itemProps.height,\n      newWidthPx: itemProps.position.widthPx,\n      newHeightPx: itemProps.position.heightPx\n    });\n\n    if (!itemProps.meta.isDragging || itemProps.glued) {\n      return this.getNoMovementResult(state, itemProps, movementChange);\n    } else if (!this.itemHasMoved(itemProps, movementChange)) {\n      return this.getNoMovementResult(state, itemProps, movementChange);\n    }\n\n    return this.onItemMovement(itemProps, state, movementChange);\n  },\n  onItemDragStop: function onItemDragStop(itemProps, items, gridWidth, gridHeight, gridOptions, gridSizing) {\n    var width = itemProps.width,\n        height = itemProps.height,\n        x = itemProps.x,\n        y = itemProps.y;\n    var gridRows = gridOptions.gridRows,\n        gridColumns = gridOptions.gridColumns,\n        renderMode = gridOptions.renderMode;\n\n    var meta = _objectSpread({}, itemProps.meta, {\n      isDragging: false\n    });\n\n    var position = this.getItemPosition(gridWidth, gridHeight, gridRows, gridColumns, width, height, x, y, renderMode);\n    var styles = this.getItemPositionStyles(gridOptions, itemProps.styles, position);\n\n    var updatedItem = _objectSpread({}, itemProps, {\n      position: position,\n      styles: styles,\n      meta: meta\n    });\n\n    return updatedItem;\n  },\n  onItemResizeStart: function onItemResizeStart(itemProps) {\n    if (itemProps.glued) {\n      return {\n        item: itemProps,\n        success: false\n      };\n    }\n\n    var item = _objectSpread({}, itemProps, {\n      meta: _objectSpread({}, itemProps.meta, {\n        isResizing: true\n      })\n    });\n\n    return {\n      item: item,\n      success: true\n    };\n  },\n  onItemResize: function onItemResize(itemProps, state, movementDetails) {\n    var movementChange = _objectSpread({}, this.calculateResizeChange(itemProps, state.gridOptions, state.gridSizing, movementDetails), {\n      newX: itemProps.x,\n      newY: itemProps.y,\n      newLeftPx: itemProps.position.leftPx,\n      newTopPx: itemProps.position.topPx\n    });\n\n    if (!itemProps.meta.isResizing || itemProps.glued) {\n      return this.getNoMovementResult(state, itemProps, movementChange);\n    } else if (!this.itemHasResized(itemProps, movementChange)) {\n      return this.getNoMovementResult(state, itemProps, movementChange);\n    }\n\n    return this.onItemMovement(itemProps, state, movementChange);\n  },\n  onItemResizeStop: function onItemResizeStop(itemProps, items, gridWidth, gridHeight, gridOptions, gridSizing) {\n    var width = itemProps.width,\n        height = itemProps.height,\n        x = itemProps.x,\n        y = itemProps.y;\n    var gridRows = gridOptions.gridRows,\n        gridColumns = gridOptions.gridColumns,\n        renderMode = gridOptions.renderMode;\n\n    var meta = _objectSpread({}, itemProps.meta, {\n      isResizing: false\n    });\n\n    var position = this.getItemPosition(gridWidth, gridHeight, gridRows, gridColumns, width, height, x, y, renderMode);\n    var styles = this.getItemPositionStyles(gridOptions, itemProps.styles, position);\n\n    var updatedItem = _objectSpread({}, itemProps, {\n      position: position,\n      styles: styles,\n      meta: meta\n    });\n\n    return updatedItem;\n  },\n  ///\n  /// Updates the internal 2d grid with the new item position. itemProps should contain the current values, prior to being updated\n  ///\n  updateGridWithItemMovement: function updateGridWithItemMovement(grid, itemProps, oldX, oldY, oldWidth, oldHeight) {\n    var id = itemProps.id,\n        x = itemProps.x,\n        y = itemProps.y,\n        width = itemProps.width,\n        height = itemProps.height;\n    this.ensureGridHasRow(grid, y);\n    this.setGridWithValue(grid, id, oldX, oldY, oldWidth, oldHeight, undefined, false);\n    this.setGridWithValue(grid, id, x, y, width, height, itemProps, true);\n  },\n  updateGridWithItem: function updateGridWithItem(grid, itemProps) {\n    var id = itemProps.id,\n        x = itemProps.x,\n        y = itemProps.y,\n        width = itemProps.width,\n        height = itemProps.height;\n    this.setGridWithValue(grid, id, x, y, width, height, itemProps, true);\n  },\n  removeGridItem: function removeGridItem(gridItems, grid, itemProps, gridOptions, gridSizing) {\n    var _this4 = this;\n\n    var id = itemProps.id,\n        x = itemProps.x,\n        y = itemProps.y,\n        width = itemProps.width,\n        height = itemProps.height;\n    var widthPx = gridSizing.widthPx,\n        heightPx = gridSizing.heightPx;\n    var renderMode = gridOptions.renderMode;\n    this.ensureGridHasRow(grid, y);\n    this.setGridWithValue(grid, id, x, y, width, height, undefined, true); // todo handle grid resize\n\n    var itemsReverted = gridOptions.algo.onGridItemRemoved(itemProps, grid, gridOptions);\n    var updatedItems = gridItems.map(function (item) {\n      var revertDetails = itemsReverted.find(function (i) {\n        return i.id === item.id;\n      });\n      if (!revertDetails) return null;\n      var x = revertDetails.x,\n          y = revertDetails.y,\n          width = revertDetails.width,\n          height = revertDetails.height;\n\n      var movedItem = _objectSpread({}, item, {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      });\n\n      var position = _this4.getItemPosition(widthPx, heightPx, gridOptions.gridRows, gridOptions.gridColumns, width, height, x, y, renderMode);\n\n      movedItem.position = position;\n      movedItem.styles = _this4.getItemPositionStyles(gridOptions, movedItem.styles, position);\n      return movedItem;\n    }).filter(function (item) {\n      return item != null;\n    });\n    return {\n      updatedItems: updatedItems\n    };\n  },\n  ensureGridHasRow: function ensureGridHasRow(grid, rowIndex) {\n    if (!grid[rowIndex]) grid[rowIndex] = [];\n  },\n  ///\n  /// Set the internal 2d grid with the value specified within the { x, x + width, y, y + height } range as long as the cell does not contain a different item already\n  ///\n  setGridWithValue: function setGridWithValue(grid, id, x, y, width, height, value) {\n    var overwrite = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : false;\n\n    for (var j = y; j < y + height; j++) {\n      for (var i = x; i < x + width; i++) {\n        var cellValue = grid[j][i];\n        if (!_helpers__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isDefined(cellValue) || cellValue.id == id || overwrite) grid[j][i] = value;\n      }\n    }\n  },\n  getItemPositionStyles: function getItemPositionStyles(gridOptions, styles, position) {\n    var _ref = styles || {},\n        transform = _ref.transform,\n        left = _ref.left,\n        top = _ref.top,\n        otherStyles = _objectWithoutProperties(_ref, [\"transform\", \"left\", \"top\"]);\n\n    if (position.ending === '%') {\n      return _objectSpread({}, otherStyles, {\n        left: \"\".concat(position.leftPct, \"%\"),\n        top: \"\".concat(position.topPct, \"%\"),\n        width: \"\".concat(position.widthPct, \"%\"),\n        height: \"\".concat(position.heightPct, \"%\")\n      });\n    } else if (gridOptions.enableCSS3) {\n      return _objectSpread({}, otherStyles, {\n        width: \"\".concat(position.widthPx, \"px\"),\n        height: \"\".concat(position.heightPx, \"px\"),\n        transform: \"translate(\".concat(position.leftPx, \"px, \").concat(position.topPx, \"px)\")\n      });\n    }\n\n    return _objectSpread({}, otherStyles, {\n      left: \"\".concat(position.leftPx, \"px\"),\n      top: \"\".concat(position.topPx, \"px\"),\n      width: \"\".concat(position.widthPx, \"px\"),\n      height: \"\".concat(position.heightPx, \"px\")\n    });\n  },\n  ///\n  /// Gets the internal grid x,y equivalent for the supplied top & left px values\n  ///\n  getGridXY: function getGridXY(gridSizing, topPx, leftPx) {\n    var gridWidth = gridSizing.gridWidth,\n        gridHeight = gridSizing.gridHeight,\n        gridRows = gridSizing.gridRows,\n        gridColumns = gridSizing.gridColumns;\n    var x = this.getGridPosition(gridWidth, leftPx, gridColumns);\n    var y = this.getGridPosition(gridHeight, topPx, gridRows);\n    return {\n      x: x,\n      y: y\n    };\n  },\n  getGridWH: function getGridWH(gridWidth, gridHeight, widthPx, heightPx, gridSizing) {\n    var gridRows = gridSizing.gridRows,\n        gridColumns = gridSizing.gridColumns;\n    var width = this.getGridPosition(gridWidth, widthPx, gridColumns);\n    var height = this.getGridPosition(gridHeight, heightPx, gridRows);\n    return {\n      width: width,\n      height: height\n    };\n  },\n  getGridPosition: function getGridPosition(gridPixels, itemPixels, matrixLevels) {\n    return Math.max(1, Math.round(itemPixels / gridPixels * matrixLevels));\n  },\n  getBoundaryLimitedSizing: function getBoundaryLimitedSizing(currentLeftPx, currentTopPx, currentWidthPx, currentHeightPx, boundaries, gridOptions) {\n    var resizeGridDirections = gridOptions.resizeGridDirections,\n        itemsCanResizeGrid = gridOptions.itemsCanResizeGrid;\n    var rightBoundary = boundaries.rightBoundary,\n        bottomBoundary = boundaries.bottomBoundary;\n    var xResizeable = itemsCanResizeGrid && resizeGridDirections !== _options__WEBPACK_IMPORTED_MODULE_1__[\"resizeOptions\"].y;\n    var yResizeable = itemsCanResizeGrid && resizeGridDirections !== _options__WEBPACK_IMPORTED_MODULE_1__[\"resizeOptions\"].x;\n    var widthPx = xResizeable ? currentWidthPx : Math.min(currentWidthPx, rightBoundary - currentLeftPx);\n    var heightPx = yResizeable ? currentHeightPx : Math.min(currentHeightPx, bottomBoundary - currentTopPx);\n    return {\n      widthPx: widthPx,\n      heightPx: heightPx\n    };\n  }\n});\n\n/***/ }),\n\n/***/ \"./src/helpers.js\":\n/*!************************!*\\\n  !*** ./src/helpers.js ***!\n  \\************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\nvar isDefined = function isDefined(item) {\n  return typeof item !== 'undefined' && item != null;\n};\n\nvar objIsInArray = function objIsInArray(array, obj, key) {\n  var objKeyValue = obj[key];\n  return array.find(function (item) {\n    return item[key] === objKeyValue;\n  }) != null;\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  isDefined: isDefined,\n  objIsInArray: objIsInArray\n});\n\n/***/ }),\n\n/***/ \"./src/options.js\":\n/*!************************!*\\\n  !*** ./src/options.js ***!\n  \\************************/\n/*! exports provided: renderModeType, resizeOptions, defaultItemOptions, defaultGridOptions, defaultPlaceholderStyles */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"renderModeType\", function() { return renderModeType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resizeOptions\", function() { return resizeOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultItemOptions\", function() { return defaultItemOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultGridOptions\", function() { return defaultGridOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultPlaceholderStyles\", function() { return defaultPlaceholderStyles; });\nvar renderModeType = {\n  // flex = percentages\n  flex: 'flex',\n  // fixed = px\n  fixed: 'fixed'\n};\nvar resizeOptions = {\n  // boxes are fixed width\n  none: 'none',\n  // resize x direction only\n  x: 'x',\n  // resize y direction \n  y: 'y',\n  // resize both\n  both: 'both'\n};\nvar defaultItemOptions = {\n  x: 0,\n  y: 0,\n  width: 1,\n  height: 1,\n  classes: [],\n  glued: false,\n  // not yet supported but is partially done in the algo, do not alter\n  visible: true,\n  canResize: true,\n  displayResize: true,\n  position: {\n    topPx: 0,\n    leftPx: 0,\n    topPct: 0,\n    leftPct: 0,\n    widthPx: 0,\n    heightPx: 0,\n    widthPct: 0,\n    heightPct: 0,\n    ending: 'px'\n  },\n  meta: {\n    isDragging: false\n  }\n};\nvar defaultPlaceholderStyles = {\n  position: 'absolute',\n  border: '2px dashed grey',\n  zIndex: -1\n};\nvar defaultGridOptions = {\n  gridColumns: 12,\n  gridRows: 12,\n  width: '100%',\n  height: '100%',\n  itemClassName: 'grid-item',\n  // any extra classes to add to the element\n  classes: [],\n  // whether to render the grid items using percentages or pixel values\n  renderMode: renderModeType.flex,\n  // when a dragged element pushes others out of the way, they may return to their \n  // old spot if dragging continues\n  stickyElements: true,\n  // show the grid lines: not currently supported\n  //showGrid: false,\n  // can resize the grid by dragging elements\n  itemsCanResizeGrid: true,\n  // which directions the grid can resize in (either dragging handle or items)\n  resizeGridDirections: resizeOptions.y,\n  // move items using transitions\n  useTransition: true,\n  // specific options for transitions\n  transitionDuration: 600,\n  // On an individual transition completed for an element (multiple fires when multiple elements moved)\n  onTransitionComplete: function onTransitionComplete(element, details, eventIfFired) {},\n  // On all transitions completed for a given element\n  onAllTransitionsComplete: function onAllTransitionsComplete(element, details, eventIfFired) {},\n  // class name for the resize handle\n  resizeClassName: 'snap-resize-handle',\n  enableCSS3: true,\n  algorithm: null\n};\n\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=curator-core.js.map","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"helpers\"] = factory();\n\telse\n\t\troot[\"helpers\"] = factory();\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/helpers.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/helpers.js\":\n/*!************************!*\\\n  !*** ./src/helpers.js ***!\n  \\************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\nvar isDefined = function isDefined(item) {\n  return typeof item !== 'undefined' && item != null;\n};\n\nvar objIsInArray = function objIsInArray(array, obj, key) {\n  var objKeyValue = obj[key];\n  return array.find(function (item) {\n    return item[key] === objKeyValue;\n  }) != null;\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  isDefined: isDefined,\n  objIsInArray: objIsInArray\n});\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=helpers.js.map","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"options\"] = factory();\n\telse\n\t\troot[\"options\"] = factory();\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/options.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/options.js\":\n/*!************************!*\\\n  !*** ./src/options.js ***!\n  \\************************/\n/*! exports provided: renderModeType, resizeOptions, defaultItemOptions, defaultGridOptions, defaultPlaceholderStyles */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"renderModeType\", function() { return renderModeType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resizeOptions\", function() { return resizeOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultItemOptions\", function() { return defaultItemOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultGridOptions\", function() { return defaultGridOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultPlaceholderStyles\", function() { return defaultPlaceholderStyles; });\nvar renderModeType = {\n  // flex = percentages\n  flex: 'flex',\n  // fixed = px\n  fixed: 'fixed'\n};\nvar resizeOptions = {\n  // boxes are fixed width\n  none: 'none',\n  // resize x direction only\n  x: 'x',\n  // resize y direction \n  y: 'y',\n  // resize both\n  both: 'both'\n};\nvar defaultItemOptions = {\n  x: 0,\n  y: 0,\n  width: 1,\n  height: 1,\n  classes: [],\n  glued: false,\n  // not yet supported but is partially done in the algo, do not alter\n  visible: true,\n  canResize: true,\n  displayResize: true,\n  position: {\n    topPx: 0,\n    leftPx: 0,\n    topPct: 0,\n    leftPct: 0,\n    widthPx: 0,\n    heightPx: 0,\n    widthPct: 0,\n    heightPct: 0,\n    ending: 'px'\n  },\n  meta: {\n    isDragging: false\n  }\n};\nvar defaultPlaceholderStyles = {\n  position: 'absolute',\n  border: '2px dashed grey',\n  zIndex: -1\n};\nvar defaultGridOptions = {\n  gridColumns: 12,\n  gridRows: 12,\n  width: '100%',\n  height: '100%',\n  itemClassName: 'grid-item',\n  // any extra classes to add to the element\n  classes: [],\n  // whether to render the grid items using percentages or pixel values\n  renderMode: renderModeType.flex,\n  // when a dragged element pushes others out of the way, they may return to their \n  // old spot if dragging continues\n  stickyElements: true,\n  // show the grid lines: not currently supported\n  //showGrid: false,\n  // can resize the grid by dragging elements\n  itemsCanResizeGrid: true,\n  // which directions the grid can resize in (either dragging handle or items)\n  resizeGridDirections: resizeOptions.y,\n  // move items using transitions\n  useTransition: true,\n  // specific options for transitions\n  transitionDuration: 600,\n  // On an individual transition completed for an element (multiple fires when multiple elements moved)\n  onTransitionComplete: function onTransitionComplete(element, details, eventIfFired) {},\n  // On all transitions completed for a given element\n  onAllTransitionsComplete: function onAllTransitionsComplete(element, details, eventIfFired) {},\n  // class name for the resize handle\n  resizeClassName: 'snap-resize-handle',\n  enableCSS3: true,\n  algorithm: null\n};\n\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=options.js.map","const options = require('./build/options')\r\n\r\nmodule.exports = require('./build/curator-core').default\r\nmodule.exports.helpers = require('./build/helpers').default\r\nmodule.exports.defaultGridOptions = options.defaultGridOptions\r\nmodule.exports.defaultItemOptions = options.defaultItemOptions\r\nmodule.exports.renderModeType = options.renderModeType\r\nmodule.exports.resizeOptions = options.resizeOptions\r\nmodule.exports.defaultPlaceholderStyles = options.defaultPlaceholderStyles","import SnapperCore, { helpers } from 'curator-core'\r\n\r\nexport default class StickyAlgo {\r\n    getItemInitialData( itemProps ) {\r\n        return {\r\n            previousX: itemProps.x,\r\n            previousY: itemProps.y,\r\n            previousWidth: itemProps.width,\r\n            previousHeight: itemProps.height\r\n        }\r\n    }\r\n\r\n    updatedItem( item, newX, newY, newWidth, newHeight ) {\r\n        item.x = newX\r\n        item.y = newY\r\n        item.width = newWidth\r\n        item.height = newHeight\r\n        item.newX = newX\r\n        item.newY = newY\r\n        item.newWidth = newWidth\r\n        item.newHeight = newHeight\r\n    }\r\n\r\n    onGridItemRemoved( item, grid, gridOptions ) {\r\n        const { previousX, previousY } = item.algoData\r\n        const revertedItems = this.revertPreviousMovements( item, previousX, previousY, grid, gridOptions )\r\n\r\n        return revertedItems\r\n    }\r\n\r\n    run ( state, itemProps, newX, newY, newWidth, newHeight ) {\r\n        const { grid, gridOptions, items } = state\r\n        const { gridColumns, gridRows } = gridOptions\r\n        const item = {\r\n            ...itemProps,\r\n        }\r\n        const allItems = {}\r\n        state.items.forEach(i => allItems[ i.id ] = i)\r\n\r\n        // get any collisions for this movement\r\n        const collisions = this.getCollisions( allItems, grid, newX, newY, newWidth, newHeight, [ itemProps.id ] )\r\n\r\n        // hitting a glued element stops any movement possibility\r\n        if ( this.hasHitGluedElement( collisions ) )\r\n            return { success: false }\r\n\r\n        // get a copy of the item\r\n        this.updatedItem( item, newX, newY, newWidth, newHeight )\r\n\r\n        // ok, this item can go where it wants. update the grid\r\n        SnapperCore.updateGridWithItemMovement( grid, item, itemProps.x, itemProps.y, itemProps.width, itemProps.height )\r\n\r\n        // remove any previously registered movements resulting from collisions\r\n        this.setPreviousMovements( item, true )\r\n\r\n        // set the resize directions as according to the users supplied options\r\n        this._canResizeX = gridOptions.itemsCanResizeGrid && gridOptions.resizeGridDirections !== 'y'\r\n        this._canResizeY = gridOptions.itemsCanResizeGrid && gridOptions.resizeGridDirections !== 'x'\r\n\r\n        // run the algo\r\n        const { itemsToMove, maxRows, maxCols } = this.getMoveDetails( allItems, grid, item, newX, newY, newWidth, newHeight, collisions)\r\n \r\n        const updatedItems = {}\r\n        // for each updated item, update the grid and add it to the list of updated items\r\n        itemsToMove.forEach( itm => {\r\n            const i = allItems[ itm.id ]\r\n            const clone = { ...i }\r\n\r\n            this.updatedItem( clone, itm.newX, itm.newY, itm.width, itm.height )\r\n            SnapperCore.updateGridWithItemMovement(grid, clone, i.x, i.y, i.width, i.height)\r\n            \r\n            updatedItems[ i.id ] = clone\r\n        })\r\n\r\n        // add the currently moved item to the update list\r\n        updatedItems[ item.id ] = item\r\n\r\n        // try to move any items back to where they were if possible\r\n        const revertedItems = this.revertPreviousMovements( item, itemProps.x, itemProps.y, grid, gridOptions, items, collisions )\r\n\r\n        // add all reverted items to the update list\r\n        revertedItems.forEach( i => {\r\n            const { x, y } = i\r\n\r\n            updatedItems[ i.id ] = {\r\n                ...allItems[ i.id ],\r\n                x,\r\n                y,\r\n            }\r\n        })\r\n\r\n        return {\r\n            success: true,\r\n            itemsToMove: updatedItems,\r\n            collisionCount: collisions.length,\r\n            items,\r\n            gridRows: Math.max( maxRows, gridOptions.gridRows, newY + newHeight ),\r\n            gridColumns: Math.max( maxCols, gridOptions.gridColumns, newX + newWidth ),\r\n            item\r\n        }\r\n    }\r\n\r\n    addItemToGrid( grid, gridOptions, gridSizing, items, itemProps ) {\r\n        const result = this.run( grid, gridOptions, gridSizing, items, itemProps, itemProps.x, itemProps.y, itemProps.width, itemProps.height  )\r\n        return result\r\n    }\r\n\r\n    setPreviousMovements( item, force ) {\r\n        if ( force || ( item.algoData.previousX === item.x && item.algoData.previousY === item.y )) {\r\n            item.algoData.previousX = item.x\r\n            item.algoData.previousY = item.y\r\n        }\r\n    }\r\n\r\n    revertPreviousMovements( movedItem, previousX, previousY, grid, gridOptions ) {\r\n        const { resizeGridDirections } = gridOptions\r\n\r\n        if ( resizeGridDirections === 'y' ) {\r\n            return this.revertInYDirection( movedItem, previousX, previousY, grid, gridOptions )\r\n        }\r\n        else {\r\n\r\n        }\r\n    }\r\n\r\n    revertInYDirection( movedItem, previousX, previousY, grid, gridOptions ) {\r\n        const { gridRows, gridColumns } = gridOptions\r\n        const xLimit = previousX + movedItem.width\r\n        const revertedItems = []\r\n\r\n        for ( let y = previousY + movedItem.height; y < gridRows; y++ ) {\r\n            if ( !grid[ y ] )\r\n                return revertedItems\r\n\r\n            for ( let x = previousX; x < xLimit; x++ ) {\r\n                const item = grid[ y ][ x ]\r\n\r\n                if ( !helpers.isDefined( item ))\r\n                    continue\r\n\r\n                if (this._getCloserPosition( item, item.algoData.previousX, item.algoData.previousY, grid, gridOptions )) {\r\n                    const { x, y } = item\r\n                    item.x = item.newX\r\n                    item.y = item.newY\r\n                    SnapperCore.updateGridWithItemMovement( grid, item, x, y, item.width, item.height )\r\n                    revertedItems.push( item )\r\n                }\r\n\r\n                if ( item.width + item.x >= xLimit ) {\r\n                    x = xLimit\r\n                    y = item.y + item.height - 1\r\n                }\r\n                else {\r\n                    x = item.x + item.width\r\n                }\r\n            }\r\n        }\r\n\r\n        return revertedItems\r\n    }\r\n\r\n    revertPreviousMovementsOld( movedItem, grid, gridOptions, items, collisions ) {\r\n        //let collisionCount = collisions.length\r\n        let movedIds = []\r\n        let revertedItems = []\r\n\r\n        // if the user does not want sticky elements, then\r\n        // ignore this request \r\n        if (!gridOptions.stickyElements)\r\n            return\r\n\r\n        // sort by x first then y. may need to change this to \r\n        // see what direction the dragged item is moving in\r\n        const previousMovements = items\r\n            .filter( ( item ) => {\r\n                return ( item.algoData.previousX != item.x || item.algoData.previousY != item.y )\r\n                    && item.id !== movedItem.id\r\n            } )\r\n            .sort((m1, m2) => {\r\n                const xDiff = m1.x - m2.x\r\n\r\n                if (xDiff !== 0)\r\n                    return xDiff\r\n\r\n                return m1.y - m2.y\r\n            })\r\n\r\n        for (let i = 0; i < previousMovements.length; i++) {\r\n            const item = previousMovements[i]\r\n            const { previousX, previousY } = item.algoData\r\n\r\n            if (this._getCloserPosition( item, previousX, previousY, grid, gridOptions )) {\r\n                const { x, y } = item\r\n                item.x = item.newX\r\n                item.y = item.newY\r\n                SnapperCore.updateGridWithItemMovement( grid, item, x, y, item.width, item.height )\r\n                revertedItems[ item.id ] = item\r\n\r\n                if (previousX === item.x && previousY === item.y) {\r\n                    movedIds.push(item._id);\r\n                }\r\n            }\r\n        }\r\n\r\n        return {\r\n            revertedItems,\r\n            //unmovedCollisions: collisions,\r\n        }\r\n    }\r\n\r\n    _getCloserPosition( item, x, y, grid, gridOptions ) {\r\n        const diffY = item.y - y\r\n        const diffX = item.x - x\r\n\r\n        let yIterator = Math.sign( diffY )\r\n        let xIterator = Math.sign( diffX )\r\n        let newX = x\r\n        let newY = y\r\n\r\n        if (diffX + diffY === 0)\r\n            return false;\r\n\r\n        while (true) {\r\n            if (this.canFit( newX, newY, item.width, item.height, item.id, grid, gridOptions )) {\r\n                item.newX = newX;\r\n                item.newY = newY;\r\n                return true;\r\n            }\r\n\r\n            // safe as Math.sign(0) === 0\r\n            if (newX !== item.x)\r\n                newX += xIterator\r\n\r\n            if (newY !== item.y)\r\n                newY += yIterator\r\n\r\n            if ( newX === item.x )\r\n                xIterator = 0\r\n\r\n            if ( newY === item.y )\r\n                yIterator = 0\r\n\r\n            if ( xIterator + yIterator === 0)\r\n                return false;\r\n\r\n            else if (newX > gridOptions.gridColumns || newX < 0 || newY > gridOptions.gridRows || newY < 0)\r\n                return false;\r\n        }\r\n    }\r\n\r\n    canFit( x, y, width, height, id, grid, gridOptions ) {\r\n        const {\r\n            gridColumns,\r\n            gridRows\r\n        } = gridOptions\r\n\r\n        if ( x + width > gridColumns \r\n            || x < 0\r\n            || y + height > gridRows \r\n            || y < 0\r\n        )\r\n            return false;\r\n\r\n        for ( let j = y; j < y + height; j++ ) {\r\n            const block = grid[j];\r\n\r\n            if ( !helpers.isDefined( block ) ) {\r\n                grid[j] = [];\r\n                continue;\r\n            }\r\n\r\n            for ( let i = x; i < x + width; i++ ) {\r\n                if ( helpers.isDefined( block[i] ) && block[i].id != id)\r\n                    return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    hasHitGluedElement(items) {\r\n        return this.findGluedElement( items ) != null;\r\n    }\r\n   \r\n    findGluedElement( items ) {\r\n        return items.find( item => item.glued )\r\n    }\r\n\r\n    findLargestGluedElement(items) {\r\n        const gluedElements = items.filter( i => i.glued )\r\n        const gluedItemsCount = gluedElements.length\r\n\r\n        if ( gluedItemsCount === 0 )\r\n            return null;\r\n\r\n        let largestEl = gluedElements[0];\r\n\r\n        for ( let i = 1; i < gluedItemsCount; i++) {\r\n            const iteratedItem = gluedElements[i];\r\n\r\n            if ( this._canResizeX )\r\n                largestEl = largestEl.width + largestEl.x > iteratedItem.width + iteratedItem.x ? largestEl : iteratedItem;\r\n\r\n            else\r\n                largestEl = largestEl.height + largestEl.y > iteratedItem.height + iteratedItem.y ? largestEl : iteratedItem;\r\n        }\r\n\r\n        return largestEl;\r\n    }\r\n\r\n    getCollisions( allItems, grid, newX, newY, width, height, whitelistIds ) {\r\n        const yLimit = newY + height\r\n        const xLimit = newX + width\r\n\r\n        let collisions = []\r\n        \r\n        for ( let y = newY; y < yLimit; y++ ) {\r\n            grid[ y ] = grid[ y ] || [];\r\n\r\n            for ( let x = newX; x < xLimit; x++ ) {\r\n                const cell = grid[ y ][ x ]\r\n\r\n                if ( !cell )\r\n                    continue\r\n\r\n                const gridItem = allItems[ cell.id ]\r\n\r\n                if (gridItem.visible && whitelistIds.indexOf( gridItem.id ) == -1 && !helpers.objIsInArray(collisions, gridItem, 'id'))\r\n                    collisions.push( gridItem );\r\n\r\n                const correctedX = gridItem.x + gridItem.width - 1\r\n\r\n                if ( correctedX < x )\r\n                    throw 'x invalid for grid item - incorrectly placed in grid'\r\n\r\n                x = correctedX\r\n            }\r\n        }\r\n\r\n        return collisions;\r\n    }\r\n\r\n    getMoveDetails( allItems, grid, draggedItem, newX, newY, newWidth, newHeight, collisions) {\r\n        let itemsToMove = {}\r\n        let maxRows = 0\r\n        let maxCols = 0\r\n\r\n        this.handleCollisions( newX, newY, newWidth, newHeight, collisions );\r\n\r\n        while (collisions.length > 0) {\r\n            let newCollisions = []\r\n\r\n            for (var i = 0; i < collisions.length; i++) {\r\n                const currentCollision = collisions[i];\r\n\r\n                // todo change this to \r\n                // 1. a) check if it's in the previous movements array and could move back \r\n                //    b) get next free spot - jump over glued items ( x dir if xresizeable, else ydir if yresizeable, else nearest if +ve y/x)\r\n                // 3. get collisions, add to the new collisions array\r\n                // 4. update maxRows, maxCols\r\n                // 5. return success = false if hit boundary and unable to get out\r\n\r\n                const nextCollisions = this.getNextGluedFreeCollisions( allItems, grid, draggedItem, currentCollision);\r\n                this.handleCollisions( currentCollision.newX, currentCollision.newY, currentCollision.width, currentCollision.height, nextCollisions );\r\n\r\n                newCollisions = newCollisions.concat(nextCollisions);\r\n                itemsToMove[currentCollision.id] = currentCollision;\r\n\r\n                const rowsRequired = currentCollision.newY + currentCollision.height\r\n                const columnsRequired = currentCollision.newX + currentCollision.width\r\n\r\n                if ( rowsRequired > maxRows )\r\n                    maxRows = rowsRequired\r\n\r\n                if ( columnsRequired > maxCols )\r\n                    maxCols = columnsRequired\r\n            }\r\n\r\n            collisions = newCollisions;\r\n        }\r\n\r\n        return { \r\n            itemsToMove: Object.keys(itemsToMove).map(key => itemsToMove[ key ]),\r\n            maxRows, \r\n            maxCols \r\n        }\r\n    }\r\n\r\n    getNextGluedFreeCollisions(allItems, grid, draggedItem, currentCollision) {\r\n        var nextCollisions,\r\n            gluedElement = {},\r\n            movingXDir = this._canResizeX;\r\n\r\n        while (gluedElement != null) {\r\n            nextCollisions = this.getCollisions(\r\n                allItems,\r\n                grid,\r\n                currentCollision.newX,\r\n                currentCollision.newY,\r\n                currentCollision.width,\r\n                currentCollision.height,\r\n                [ draggedItem.id, currentCollision.id ]);\r\n\r\n            gluedElement = this.findLargestGluedElement(nextCollisions);\r\n\r\n            if (gluedElement != null) {\r\n                if (movingXDir)\r\n                    currentCollision.newX = gluedElement.x + gluedElement.width;\r\n\r\n                else\r\n                    currentCollision.newY = gluedElement.y + gluedElement.height;\r\n            }\r\n        }\r\n\r\n        return nextCollisions;\r\n    }\r\n\r\n    handleCollisions( newX, newY, newWidth, newHeight, collisions ) {\r\n        var yOffset = 0,\r\n            xOffset = 0,\r\n            limit,\r\n            i,\r\n            collision,\r\n            minY = Number.MAX_SAFE_INTEGER,\r\n            minX = Number.MAX_SAFE_INTEGER;\r\n\r\n        if (collisions.length === 0)\r\n            return;\r\n        \r\n        if (this._canResizeX) {\r\n            for (i = 0, limit = collisions.length; i < limit; i++) {\r\n                collision = collisions[i];\r\n                minX = Math.min(minX, collision.x);\r\n            }\r\n\r\n            xOffset = Math.max(0, newX - minX) + newWidth - Math.max(0, minX - newX);\r\n        }\r\n        else {\r\n            for (i = 0, limit = collisions.length; i < limit; i++) {\r\n                collision = collisions[i];\r\n                minY = Math.min(minY, collision.y);\r\n            }\r\n\r\n            yOffset = Math.max(0, newY - minY) + newHeight - Math.max(0, minY - newY);\r\n        }\r\n\r\n        for (i = 0, limit = collisions.length; i < limit; i++) {\r\n            collision = collisions[i]\r\n            collision.newX = collision.x + xOffset\r\n            collision.newY = collision.y + yOffset\r\n\r\n            this.setPreviousMovements( collision, false )\r\n        }\r\n    }\r\n}"],"sourceRoot":""}