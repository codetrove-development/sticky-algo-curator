!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SnappyAlgo=t():e.SnappyAlgo=t()}(window,function(){return function(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,i){window,e.exports=function(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,i){"use strict";i.r(t);var d={flex:"flex",fixed:"fixed"},l={none:"none",x:"x",y:"y",both:"both"},n={x:0,y:0,width:1,height:1,classes:[],glued:!1,visible:!0,canResize:!0,displayResize:!0,position:{topPx:0,leftPx:0,topPct:0,leftPct:0,widthPx:0,heightPx:0,widthPct:0,heightPct:0,ending:"px"},meta:{isDragging:!1}},r={position:"absolute",border:"2px dashed grey",zIndex:-1},o={gridColumns:12,gridRows:12,width:"100%",height:"100%",itemClassName:"grid-item",classes:[],renderMode:d.flex,stickyElements:!0,itemsCanResizeGrid:!0,resizeGridDirections:l.y,useTransition:!0,transitionDuration:600,onTransitionComplete:function(e,t,i){},onAllTransitionsComplete:function(e,t,i){},resizeClassName:"snap-resize-handle",enableCSS3:!0,algorithm:null};function m(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},t=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),t.forEach(function(e){var t,i,n;t=r,n=o[i=e],i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n})}return r}i.d(t,"renderModeType",function(){return d}),i.d(t,"resizeOptions",function(){return l}),i.d(t,"defaultItemOptions",function(){return n}),i.d(t,"defaultGridOptions",function(){return o}),t.default={getItemStyles:function(){return{boxSizing:"border-box",position:"absolute"}},getItemClasses:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n,i=(e=t.classes,function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()).concat([t.itemClassName]);return t.glued&&i.push("snapper-glued"),i},getEmptyGrid:function(e){for(var t=[],i=0;i<e;i++)t.push([]);return t},getItemPosition:function(e,t,i,n,r,o,s,u,a){return a===d.flex?m({},this.getItemPositionPixels(e,t,i,n,r,o,s,u),this.getItemPositionPercentages(e,t,i,n,r,o,s,u)):this.getItemPositionPixels(e,t,i,n,r,o,s,u)},getItemPositionPercentages:function(e,t,i,n,r,o,s,u){var a=Math.floor(e/n),d=Math.floor(t/i),h=e-a*n,l=t-d*i,g=49/e/100,c=49/t/100,f=Math.min(s,h),m=Math.min(r+s,h)-f,v=Math.min(u,l);return{leftPct:100*(s*a+f)/e+g,widthPct:100*(r*a+m)/e+g,topPct:100*(u*d+v)/t+c,heightPct:100*(o*d+(Math.min(o+u,l)-v))/t+c,ending:"%"}},getItemPositionPixels:function(e,t,i,n,r,o,s,u){var a=Math.floor(e/n),d=Math.floor(t/i),h=e-a*n,l=t-d*i,g=Math.min(s,h),c=Math.min(r+s,h)-g,f=Math.min(u,l);return{widthPx:a*r+c,heightPx:d*o+(Math.min(o+u,l)-f),topPx:d*u+f,leftPx:a*s+g,ending:"px"}},updateMovedItem:function(e,t,i){var n=e.newX,r=e.newY,o=e.newWidth,s=e.newHeight,u=t.gridWidth,a=t.gridHeight,d=t.gridRows,h=t.gridColumns,l=i.renderMode,g=m({},e);if(!o||!s)return console.error("Item ".concat(key," does not have a newWidth or newHeight value. Unable to correctly resize item")),e;g.x=n,g.y=r,g.width=o,g.height=s;var c=this.getItemPosition(u,a,d,h,g.width,g.height,g.x,g.y,l),f=this.getItemPositionStyles(i,g.styles,c);return g.position=m({},c),g.styles=m({},f),g},updateGridWithMovedItems:function(e,t){for(var i in t){var n=t[i];this.updateGridWithItemMovement(e,n,n.x,n.y,n.width,n.height)}},getUpdatedMovedItems:function(e,r,o,s,u,a,d,h){var l=this;return e.forEach(function(e){var t=l.updateMovedItem(e,d,h);if(key===r){var i=m({},t.position,{ending:"px",topPx:o,leftPx:s,widthPx:u,heightPx:a}),n=l.getItemPositionStyles(h,t.styles,i);t.position=m({},i),t.styles=m({},n)}return t})},getUpdatedGridSizeItems:function(e,i,t){var n=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],o=i.renderMode,s=t.gridRows,u=t.gridColumns,a=t.gridHeight,d=t.gridWidth;return e.map(function(e){if(!(-1<r.indexOf(e.id))){var t=n.getItemPosition(d,a,s,u,e.width,e.height,e.x,e.y,o);return m({},e,{position:t,styles:n.getItemPositionStyles(i,e.styles,t)})}})},getGridBoundaries:function(e){return{leftBoundary:0,rightBoundary:e.gridWidth,topBoundary:0,bottomBoundary:e.gridHeight}},getItemSizing:function(e,t){var i=t.gridWidth,n=t.gridHeight,r=e.width,o=e.height;return{itemWidthPx:r*(i/gridColumns),itemHeightPx:o*(n/gridRows)}},calculateGridMatrixSize:function(e,t,i){var n=t.itemsCanResizeGrid,r=t.resizeGridDirections,o=i.gridRows,s=i.gridColumns,u=n&&"y"!==r,a=n&&"x"!==r;if(!u&&!a)return{rows:o,columns:s};var d=0,h=0;return e.forEach(function(e){var t=e.x+e.width,i=e.y+e.height;h<t&&(h=t),d<i&&(d=i)}),{rows:a?Math.max(d,o):o,columns:u?Math.max(h,s):s}},calculateGridSize:function(e,t,i,n){var r=t.gridRows,o=t.gridColumns;return{newGridWidth:e.widthPx/o*n,newGridHeight:e.heightPx/r*i}},calculateMovementChange:function(e,t,i,n){var r=t.itemsCanResizeGrid,o=r&&"y"!==t.resizeGridDirections,s=r&&"x"!==t.resizeGridDirections,u=i.widthPx/t.gridColumns,a=i.heightPx/t.gridRows,d=n.currentMouseX-n.initialMouseX,h=n.currentMouseY-n.initialMouseY,l=n.initialLeft+d,g=n.initialTop+h,c=Math.round(l/u),f=Math.round(g/a);return c<0?c=0:c+1>t.gridColumns&&!o&&(c=t.gridColumns-1),f<0?f=0:f+1>t.gridRows&&!s&&(f=t.gridRows-1),{newX:c,newY:f,newLeftPx:l,newTopPx:g}},calculateResizeChange:function(e,t,i,n){var r=i.widthPx/t.gridColumns,o=i.heightPx/t.gridRows,s=n.currentMouseX-n.initialMouseX,u=n.currentMouseY-n.initialMouseY,a=n.initialWidth+s,d=n.initialHeight+u,h=Math.round(a/r),l=Math.round(d/o);return a<r&&(h=1,a=r),d<o&&(l=1,d=o),{newWidthPx:a,newHeightPx:d,newWidth:h,newHeight:l,newLeftPx:e.position.leftPx,newTopPx:e.position.topPx}},calculatePositionChange:function(e,t){var i=t.gridSizing,n=t.gridOptions,r=i.widthPx/n.gridColumns,o=i.heightPx/n.gridRows;return{newWidthPx:Math.round(r*e.width),newHeightPx:Math.round(o*e.height),newLeftPx:Math.round(r*e.x),newTopPx:Math.round(o*e.y),newX:e.x,newY:e.y,newWidth:e.width,newHeight:e.height}},getNoMovementResult:function(e,t,i){var n=m({},t,{position:m({},t.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx})}),r=e.items.map(function(e){return e.id==n.id?n:e});return{success:!0,grid:e.grid,updatedItems:r,targetItem:n,gridSizing:e.gridSizing,movementChange:i,itemsMoved:!1}},itemHasMoved:function(e,t){return t.newX!=e.x||t.newY!=e.y},itemHasResized:function(e,t){return t.newWidth!==e.width||t.newHeight!==e.height},checkProposedGridSizing:function(e,t,i){var n=e.gridOptions,r=n.resizeGridDirections!==l.y,o=n.resizeGridDirections!==l.x;if(!r&&t!==n.gridColumns||n.gridColumns<1)throw"Invalid grid column proposition from algorithm";if(!o&&i!==n.gridRows||n.gridRows<1)throw"Invalid grid row proposition from algorithm"},getPlaceholderStyles:function(e){return m({},r,{left:"".concat(e.leftPx,"px"),top:"".concat(e.topPx,"px"),width:"".concat(e.widthPx,"px"),height:"".concat(e.heightPx,"px")})},addItemToGrid:function(e,t){var i={newX:e.x,newY:e.y,newWidth:e.width,newHeight:e.height,newTopPx:e.position.topPx,newLeftPx:e.position.leftPx,newWidthPx:e.position.widthPx,newHeightPx:e.position.heightPx};return this.onItemMovement(e,t,i)},movementIsWithinBounds:function(e,t){var i=t.gridColumns,n=t.gridRows,r=t.itemsCanResizeGrid,o=t.resizeGridDirections,s=e.newX,u=e.newY,a=e.newWidth,d=e.newHeight;return(r&&"y"!==o||s+a<=i)&&(r&&"x"!==o||u+d<=n)},onItemMovement:function(e,t,r){var o=this,s=t.gridOptions.renderMode,u=t.gridOptions,i=this.getNoMovementResult(t,e,r),a=m({},e);if(!this.movementIsWithinBounds(r,u))return i;var d=u.algo.run(t,a,r.newX,r.newY,r.newWidth,r.newHeight);if(!d.success)return i;var n=d.gridColumns!==u.gridColumns||d.gridRows!==u.gridRows,h=t.gridSizing.widthPx,l=t.gridSizing.heightPx;if(n){this.checkProposedGridSizing(t,d.gridColumns,d.gridRows);var g=this.calculateGridSize(t.gridSizing,u,d.gridRows,d.gridColumns);h=g.newGridWidth,l=g.newGridHeight}var c=Object.keys(d.itemsToMove).map(function(e){var t=d.itemsToMove[e],i=o.getItemPosition(h,l,d.gridRows,d.gridColumns,t.width,t.height,t.x,t.y,s);if(t.id===a.id){var n=o.getPlaceholderStyles(i);t.meta=m({},t.meta,{placeholderStyles:n}),t.position=m({},t.position,{ending:"px",topPx:r.newTopPx,leftPx:r.newLeftPx,widthPx:r.newWidthPx,heightPx:r.newHeightPx}),t.styles=o.getItemPositionStyles(u,t.styles,t.position),console.log(t.styles)}else t.position=i,t.styles=o.getItemPositionStyles(u,t.styles,i);return t});return{success:d.success,grid:t.grid,updatedItems:c,itemsMoved:1<Object.keys(d.itemsToMove).length,targetItem:a,movementChange:r,gridSizing:{gridRows:d.gridRows,gridColumns:d.gridColumns,heightPx:l,widthPx:h}}},onItemPositionChanged:function(e,t,i){var n=this.calculatePositionChange(e,i);return this.positionHasChanged(e,t)?this.onItemMovement(t,i,n):this.getNoMovementResult(i,t,n)},positionHasChanged:function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height},onItemDragStart:function(e){if(e.glued)return{item:e,success:!1};var t=this.getPlaceholderStyles(e.position);return{item:m({},e,{meta:m({},e.meta,{isDragging:!0,placeholderStyles:t})}),success:!0}},onItemDrag:function(e,t,i){var n=m({},this.calculateMovementChange(e,t.gridOptions,t.gridSizing,i),{newWidth:e.width,newHeight:e.height,newWidthPx:e.position.widthPx,newHeightPx:e.position.heightPx});return!e.meta.isDragging||e.glued?this.getNoMovementResult(t,e,n):this.itemHasMoved(e,n)?this.onItemMovement(e,t,n):this.getNoMovementResult(t,e,n)},onItemDragStop:function(e,t,i,n,r,o){var s=e.width,u=e.height,a=e.x,d=e.y,h=r.gridRows,l=r.gridColumns,g=r.renderMode,c=m({},e.meta,{isDragging:!1}),f=this.getItemPosition(i,n,h,l,s,u,a,d,g);return m({},e,{position:f,styles:this.getItemPositionStyles(r,e.styles,f),meta:c})},onItemResizeStart:function(e){return e.glued?{item:e,success:!1}:{item:m({},e,{meta:m({},e.meta,{isResizing:!0})}),success:!0}},onItemResize:function(e,t,i){var n=m({},this.calculateResizeChange(e,t.gridOptions,t.gridSizing,i),{newX:e.x,newY:e.y,newLeftPx:e.position.leftPx,newTopPx:e.position.topPx});return!e.meta.isResizing||e.glued?this.getNoMovementResult(t,e,n):this.itemHasResized(e,n)?this.onItemMovement(e,t,n):this.getNoMovementResult(t,e,n)},onItemResizeStop:function(e,t,i,n,r,o){var s=e.width,u=e.height,a=e.x,d=e.y,h=r.gridRows,l=r.gridColumns,g=r.renderMode,c=m({},e.meta,{isResizing:!1}),f=this.getItemPosition(i,n,h,l,s,u,a,d,g);return m({},e,{position:f,styles:this.getItemPositionStyles(r,e.styles,f),meta:c})},updateGridWithItemMovement:function(e,t,i,n,r,o){var s=t.id,u=t.x,a=t.y,d=t.width,h=t.height;this.ensureGridHasRow(e,a),this.setGridWithValue(e,s,i,n,r,o,void 0,!1),this.setGridWithValue(e,s,u,a,d,h,t,!0)},updateGridWithItem:function(e,t){var i=t.id,n=t.x,r=t.y,o=t.width,s=t.height;this.setGridWithValue(e,i,n,r,o,s,t,!0)},removeGridItem:function(e,t,i,a,n){var d=this,r=i.id,o=i.x,s=i.y,u=i.width,h=i.height,l=n.widthPx,g=n.heightPx,c=a.renderMode;this.ensureGridHasRow(t,s),this.setGridWithValue(t,r,o,s,u,h,void 0,!0);var f=a.algo.onGridItemRemoved(i,t,a);return{updatedItems:e.map(function(t){var e=f.find(function(e){return e.id===t.id});if(!e)return null;var i=e.x,n=e.y,r=e.width,o=e.height,s=m({},t,{x:i,y:n,width:r,height:o}),u=d.getItemPosition(l,g,a.gridRows,a.gridColumns,r,o,i,n,c);return s.position=u,s.styles=d.getItemPositionStyles(a,s.styles,u),s}).filter(function(e){return null!=e})}},ensureGridHasRow:function(e,t){e[t]||(e[t]=[])},setGridWithValue:function(e,t,i,n,r,o,s){for(var u=7<arguments.length&&void 0!==arguments[7]&&arguments[7],a=n;a<n+o;a++)for(var d=i;d<i+r;d++){var h=e[a][d];void 0!==(l=h)&&null!=l&&h.id!=t&&!u||(e[a][d]=s)}var l},getItemPositionStyles:function(e,t,i){var n=t||{},r=(n.transform,n.left,n.top,function(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],0<=t.indexOf(i)||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],0<=t.indexOf(i)||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}(n,["transform","left","top"]));return"%"===i.ending?m({},r,{left:"".concat(i.leftPct,"%"),top:"".concat(i.topPct,"%"),width:"".concat(i.widthPct,"%"),height:"".concat(i.heightPct,"%")}):e.enableCSS3?m({},r,{width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px"),transform:"translate(".concat(i.leftPx,"px, ").concat(i.topPx,"px)")}):m({},r,{left:"".concat(i.leftPx,"px"),top:"".concat(i.topPx,"px"),width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px")})},getGridXY:function(e,t,i){var n=e.gridWidth,r=e.gridHeight,o=e.gridRows,s=e.gridColumns;return{x:this.getGridPosition(n,i,s),y:this.getGridPosition(r,t,o)}},getGridWH:function(e,t,i,n,r){var o=r.gridRows,s=r.gridColumns;return{width:this.getGridPosition(e,i,s),height:this.getGridPosition(t,n,o)}},getGridPosition:function(e,t,i){return Math.max(1,Math.round(t/e*i))},getBoundaryLimitedSizing:function(e,t,i,n,r,o){var s=o.resizeGridDirections,u=o.itemsCanResizeGrid,a=r.rightBoundary,d=r.bottomBoundary,h=u&&s!==l.x;return{widthPx:u&&s!==l.y?i:Math.min(i,a-e),heightPx:h?n:Math.min(n,d-t)}}}}])},function(e,t,i){"use strict";i.r(t);var m=i(0),w=i.n(m);function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(e){r(t,e,i[e])})}return t}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,(i=[{key:"getItemInitialData",value:function(e){return{previousX:e.x,previousY:e.y,previousWidth:e.width,previousHeight:e.height}}},{key:"updatedItem",value:function(e,t,i,n,r){e.x=t,e.y=i,e.width=n,e.height=r,e.newX=t,e.newY=i,e.newWidth=n,e.newHeight=r}},{key:"onGridItemRemoved",value:function(e,t,i){var n=e.algoData,r=n.previousX,o=n.previousY;return this.revertPreviousMovements(e,r,o,t,i)}},{key:"run",value:function(e,t,i,n,r,o){var s=this,u=e.grid,a=e.gridOptions,d=e.items,h=(a.gridColumns,a.gridRows,x({},t)),l={};e.items.forEach(function(e){return l[e.id]=e});var g=this.getCollisions(l,u,i,n,r,o,[t.id]);if(this.hasHitGluedElement(g))return{success:!1};this.updatedItem(h,i,n,r,o),w.a.updateGridWithItemMovement(u,h,t.x,t.y,t.width,t.height),this.setPreviousMovements(h,!0),this._canResizeX=a.itemsCanResizeGrid&&"y"!==a.resizeGridDirections,this._canResizeY=a.itemsCanResizeGrid&&"x"!==a.resizeGridDirections;var c=this.getMoveDetails(l,u,h,i,n,r,o,g),f=c.itemsToMove,m=c.maxRows,v=c.maxCols,p={};return f.forEach(function(e){var t=l[e.id],i=x({},t);s.updatedItem(i,e.newX,e.newY,e.width,e.height),w.a.updateGridWithItemMovement(u,i,t.x,t.y,t.width,t.height),p[t.id]=i}),p[h.id]=h,this.revertPreviousMovements(h,t.x,t.y,u,a,d,g).forEach(function(e){var t=e.x,i=e.y;p[e.id]=x({},l[e.id],{x:t,y:i})}),{success:!0,itemsToMove:p,collisionCount:g.length,items:d,gridRows:Math.max(m,a.gridRows,n+o),gridColumns:Math.max(v,a.gridColumns,i+r),item:h}}},{key:"addItemToGrid",value:function(e,t,i,n,r){return this.run(e,t,i,n,r,r.x,r.y,r.width,r.height)}},{key:"setPreviousMovements",value:function(e,t){(t||e.algoData.previousX===e.x&&e.algoData.previousY===e.y)&&(e.algoData.previousX=e.x,e.algoData.previousY=e.y)}},{key:"revertPreviousMovements",value:function(e,t,i,n,r){if("y"===r.resizeGridDirections)return this.revertInYDirection(e,t,i,n,r)}},{key:"revertInYDirection",value:function(e,t,i,n,r){for(var o=r.gridRows,s=(r.gridColumns,t+e.width),u=[],a=i+e.height;a<o;a++){if(!n[a])return u;for(var d=t;d<s;d++){var h=n[a][d];if(m.helpers.isDefined(h)){if(this._getCloserPosition(h,h.algoData.previousX,h.algoData.previousY,n,r)){var l=h.x,g=h.y;h.x=h.newX,h.y=h.newY,w.a.updateGridWithItemMovement(n,h,l,g,h.width,h.height),u.push(h)}h.width+h.x>=s?(d=s,a=h.y+h.height-1):d=h.x+h.width}}}return u}},{key:"revertPreviousMovementsOld",value:function(t,e,i,n,r){var o=[],s=[];if(i.stickyElements){for(var u=n.filter(function(e){return(e.algoData.previousX!=e.x||e.algoData.previousY!=e.y)&&e.id!==t.id}).sort(function(e,t){var i=e.x-t.x;return 0!==i?i:e.y-t.y}),a=0;a<u.length;a++){var d=u[a],h=d.algoData,l=h.previousX,g=h.previousY;if(this._getCloserPosition(d,l,g,e,i)){var c=d.x,f=d.y;d.x=d.newX,d.y=d.newY,w.a.updateGridWithItemMovement(e,d,c,f,d.width,d.height),l===(s[d.id]=d).x&&g===d.y&&o.push(d._id)}}return{revertedItems:s}}}},{key:"_getCloserPosition",value:function(e,t,i,n,r){var o=e.y-i,s=e.x-t,u=Math.sign(o),a=Math.sign(s),d=t,h=i;if(s+o===0)return!1;for(;;){if(this.canFit(d,h,e.width,e.height,e.id,n,r))return e.newX=d,e.newY=h,!0;if(d!==e.x&&(d+=a),h!==e.y&&(h+=u),d===e.x&&(a=0),h===e.y&&(u=0),a+u===0)return!1;if(d>r.gridColumns||d<0||h>r.gridRows||h<0)return!1}}},{key:"canFit",value:function(e,t,i,n,r,o,s){var u=s.gridColumns,a=s.gridRows;if(u<e+i||e<0||a<t+n||t<0)return!1;for(var d=t;d<t+n;d++){var h=o[d];if(m.helpers.isDefined(h)){for(var l=e;l<e+i;l++)if(m.helpers.isDefined(h[l])&&h[l].id!=r)return!1}else o[d]=[]}return!0}},{key:"hasHitGluedElement",value:function(e){return null!=this.findGluedElement(e)}},{key:"findGluedElement",value:function(e){return e.find(function(e){return e.glued})}},{key:"findLargestGluedElement",value:function(e){var t=e.filter(function(e){return e.glued}),i=t.length;if(0===i)return null;for(var n=t[0],r=1;r<i;r++){var o=t[r];n=this._canResizeX?n.width+n.x>o.width+o.x?n:o:n.height+n.y>o.height+o.y?n:o}return n}},{key:"getCollisions",value:function(e,t,i,n,r,o,s){for(var u=n+o,a=i+r,d=[],h=n;h<u;h++){t[h]=t[h]||[];for(var l=i;l<a;l++){var g=t[h][l];if(g){var c=e[g.id];c.visible&&-1==s.indexOf(c.id)&&!m.helpers.objIsInArray(d,c,"id")&&d.push(c);var f=c.x+c.width-1;if(f<l)throw"x invalid for grid item - incorrectly placed in grid";l=f}}}return d}},{key:"getMoveDetails",value:function(e,t,i,n,r,o,s,u){var a={},d=0,h=0;for(this.handleCollisions(n,r,o,s,u);0<u.length;){for(var l=[],g=0;g<u.length;g++){var c=u[g],f=this.getNextGluedFreeCollisions(e,t,i,c);this.handleCollisions(c.newX,c.newY,c.width,c.height,f),l=l.concat(f);var m=(a[c.id]=c).newY+c.height,v=c.newX+c.width;d<m&&(d=m),h<v&&(h=v)}u=l}return{itemsToMove:Object.keys(a).map(function(e){return a[e]}),maxRows:d,maxCols:h}}},{key:"getNextGluedFreeCollisions",value:function(e,t,i,n){for(var r,o={},s=this._canResizeX;null!=o;)r=this.getCollisions(e,t,n.newX,n.newY,n.width,n.height,[i.id,n.id]),null!=(o=this.findLargestGluedElement(r))&&(s?n.newX=o.x+o.width:n.newY=o.y+o.height);return r}},{key:"handleCollisions",value:function(e,t,i,n,r){var o,s,u,a=0,d=0,h=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;if(0!==r.length){if(this._canResizeX){for(s=0,o=r.length;s<o;s++)u=r[s],l=Math.min(l,u.x);d=Math.max(0,e-l)+i-Math.max(0,l-e)}else{for(s=0,o=r.length;s<o;s++)u=r[s],h=Math.min(h,u.y);a=Math.max(0,t-h)+n-Math.max(0,h-t)}for(s=0,o=r.length;s<o;s++)(u=r[s]).newX=u.x+d,u.newY=u.y+a,this.setPreviousMovements(u,!1)}}}])&&o(t.prototype,i),n&&o(t,n),e}();t.default=n}])});